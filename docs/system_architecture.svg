<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 1050" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <!-- Gradients -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#0f1923"/>
      <stop offset="100%" stop-color="#1a2744"/>
    </linearGradient>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#ff9900"/>
      <stop offset="100%" stop-color="#ffad33"/>
    </linearGradient>
    <!-- AWS Orange -->
    <linearGradient id="awsOrange" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#ff9900"/>
      <stop offset="100%" stop-color="#e68a00"/>
    </linearGradient>
    <!-- Compute -->
    <linearGradient id="computeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#ED7100"/>
      <stop offset="100%" stop-color="#c45e00"/>
    </linearGradient>
    <!-- AI/ML -->
    <linearGradient id="aiGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#01A88D"/>
      <stop offset="100%" stop-color="#00876e"/>
    </linearGradient>
    <!-- Database -->
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#3B48CC"/>
      <stop offset="100%" stop-color="#2d38a0"/>
    </linearGradient>
    <!-- Security -->
    <linearGradient id="secGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#DD344C"/>
      <stop offset="100%" stop-color="#b82a3e"/>
    </linearGradient>
    <!-- App Integration -->
    <linearGradient id="intGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#E7157B"/>
      <stop offset="100%" stop-color="#bf1266"/>
    </linearGradient>
    <!-- Networking -->
    <linearGradient id="netGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#8C4FFF"/>
      <stop offset="100%" stop-color="#7040cc"/>
    </linearGradient>
    <!-- Management -->
    <linearGradient id="mgmtGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#E7157B"/>
      <stop offset="100%" stop-color="#bf1266"/>
    </linearGradient>
    <!-- Storage -->
    <linearGradient id="storGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#3F8624"/>
      <stop offset="100%" stop-color="#2e6a1a"/>
    </linearGradient>

    <!-- Arrow -->
    <marker id="arr" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#90a4ae"/>
    </marker>
    <marker id="arrGold" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ff9900"/>
    </marker>
    <marker id="arrGreen" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#4CAF50"/>
    </marker>
    <marker id="arrRed" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ef5350"/>
    </marker>

    <!-- Shadow -->
    <filter id="sh">
      <feGaussianBlur in="SourceAlpha" stdDeviation="4"/>
      <feOffset dx="2" dy="3"/>
      <feComponentTransfer><feFuncA type="linear" slope="0.35"/></feComponentTransfer>
      <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>

    <!-- Glow for active paths -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- ===================== BACKGROUND ===================== -->
  <rect width="1440" height="1050" fill="url(#bgGrad)" rx="12"/>

  <!-- Grid pattern -->
  <g opacity="0.04">
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(120,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(240,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(360,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(480,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(600,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(720,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(840,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(960,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(1080,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(1200,0)" />
    <line x1="0" y1="0" x2="0" y2="1050" stroke="white" stroke-width="1" transform="translate(1320,0)" />
  </g>

  <!-- ===================== TITLE ===================== -->
  <rect x="0" y="0" width="1440" height="70" fill="url(#headerGrad)" rx="12" />
  <rect x="0" y="35" width="1440" height="35" fill="url(#headerGrad)"/>
  <text x="720" y="30" font-size="26" font-weight="bold" fill="#232f3e" text-anchor="middle" letter-spacing="1">Insurance Customer Support AI Agent â€” System Architecture</text>
  <text x="720" y="58" font-size="14" fill="#232f3e" text-anchor="middle" opacity="0.8">Amazon Bedrock  Â·  RAG (OpenSearch)  Â·  Step Functions  Â·  Human-in-the-Loop  Â·  AWS CDK</text>

  <!-- ===================== SECTION 1: CUSTOMER CHANNELS ===================== -->
  <text x="80" y="110" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">CUSTOMER CHANNELS</text>
  <line x1="80" y1="118" x2="240" y2="118" stroke="#ff9900" stroke-width="2"/>

  <!-- SES Email -->
  <g transform="translate(80,140)" filter="url(#sh)">
    <rect width="150" height="90" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <!-- SES Icon: envelope shape in AWS orange -->
    <g transform="translate(15,12)">
      <rect width="40" height="30" rx="3" fill="none" stroke="#ff9900" stroke-width="2.5"/>
      <polyline points="0,0 20,18 40,0" fill="none" stroke="#ff9900" stroke-width="2.5"/>
      <polyline points="0,30 14,16" fill="none" stroke="#ff9900" stroke-width="1.5"/>
      <polyline points="40,30 26,16" fill="none" stroke="#ff9900" stroke-width="1.5"/>
    </g>
    <text x="65" y="26" font-size="13" fill="white" font-weight="bold">Amazon SES</text>
    <text x="65" y="42" font-size="10" fill="#94a3b8">Simple Email Service</text>
    <text x="75" y="72" font-size="11" fill="#cbd5e1" text-anchor="middle">ğŸ“§ Email Ingestion</text>
  </g>

  <!-- API Gateway -->
  <g transform="translate(80,250)" filter="url(#sh)">
    <rect width="150" height="90" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <!-- API GW Icon: gateway shape in purple -->
    <g transform="translate(15,10)">
      <rect x="5" y="2" width="30" height="32" rx="4" fill="none" stroke="#8C4FFF" stroke-width="2.5"/>
      <line x1="20" y1="2" x2="20" y2="34" stroke="#8C4FFF" stroke-width="1.5"/>
      <line x1="5" y1="13" x2="35" y2="13" stroke="#8C4FFF" stroke-width="1.5"/>
      <line x1="5" y1="24" x2="35" y2="24" stroke="#8C4FFF" stroke-width="1.5"/>
      <circle cx="20" cy="13" r="3" fill="#8C4FFF"/>
    </g>
    <text x="65" y="26" font-size="13" fill="white" font-weight="bold">API Gateway</text>
    <text x="65" y="42" font-size="10" fill="#94a3b8">REST API Endpoint</text>
    <text x="75" y="72" font-size="11" fill="#cbd5e1" text-anchor="middle">ğŸ’¬ WhatsApp / Chat</text>
  </g>

  <!-- Arrows from channels to pipeline -->
  <path d="M230 185 Q280 185 310 260" fill="none" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)" stroke-dasharray="6,4"/>
  <path d="M230 295 L310 295" fill="none" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)" stroke-dasharray="6,4"/>

  <!-- ===================== SECTION 2: PROCESSING PIPELINE ===================== -->
  <text x="340" y="110" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">ORCHESTRATION PIPELINE</text>
  <line x1="340" y1="118" x2="580" y2="118" stroke="#ff9900" stroke-width="2"/>

  <!-- Step Functions border -->
  <rect x="310" y="130" width="820" height="440" rx="12" fill="none" stroke="#ff9900" stroke-width="2" stroke-dasharray="8,4" opacity="0.5"/>
  <g transform="translate(318,128)">
    <rect width="180" height="22" rx="4" fill="#232f3e"/>
    <text x="10" y="15" font-size="11" fill="#ff9900" font-weight="bold">âš™ï¸ AWS Step Functions</text>
  </g>

  <!-- Stage 1: Lambda + Textract (Attachment Processing) -->
  <g transform="translate(340,160)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#ED7100" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#computeGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#computeGrad)"/>
    <!-- Lambda symbol Î» -->
    <g transform="translate(10,5)">
      <text font-size="16" fill="white" font-weight="bold">Î»</text>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">AWS Lambda</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Ingestion +</text>
    <text x="80" y="72" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Attachments</text>
    <!-- Textract sub-icon -->
    <g transform="translate(15,82)">
      <rect width="12" height="16" rx="1" fill="none" stroke="#01A88D" stroke-width="1.5"/>
      <line x1="3" y1="5" x2="9" y2="5" stroke="#01A88D" stroke-width="1"/>
      <line x1="3" y1="8" x2="9" y2="8" stroke="#01A88D" stroke-width="1"/>
      <line x1="3" y1="11" x2="7" y2="11" stroke="#01A88D" stroke-width="1"/>
    </g>
    <text x="32" y="96" font-size="9" fill="#01A88D">Amazon Textract</text>
  </g>

  <!-- Arrow -->
  <line x1="500" y1="215" x2="530" y2="215" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Stage 2: Comprehend (PII Redaction) -->
  <g transform="translate(540,160)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#DD344C" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#secGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#secGrad)"/>
    <!-- Comprehend icon: brain/text -->
    <g transform="translate(10,4)">
      <circle cx="8" cy="10" r="7" fill="none" stroke="white" stroke-width="1.5"/>
      <path d="M4,8 Q8,3 12,8 Q8,13 4,8" fill="none" stroke="white" stroke-width="1"/>
    </g>
    <text x="30" y="18" font-size="11" fill="white" font-weight="bold">Amazon Comprehend</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">PII Redaction</text>
    <text x="80" y="72" font-size="10" fill="#94a3b8" text-anchor="middle">SSN Â· CC Â· Policy#</text>
    <!-- Shield icon -->
    <g transform="translate(60,80)">
      <path d="M10,0 L20,4 L20,14 Q20,22 10,26 Q0,22 0,14 L0,4 Z" fill="none" stroke="#DD344C" stroke-width="1.5"/>
      <text x="10" y="18" font-size="10" fill="#DD344C" text-anchor="middle">ğŸ”’</text>
    </g>
    <text x="90" y="96" font-size="9" fill="#DD344C">+ SageMaker NER</text>
  </g>

  <!-- Arrow -->
  <line x1="700" y1="215" x2="730" y2="215" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Stage 3: Bedrock (Intent Classification) -->
  <g transform="translate(740,160)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#01A88D" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#aiGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#aiGrad)"/>
    <!-- Bedrock icon: layered blocks -->
    <g transform="translate(8,3)">
      <rect x="0" y="12" width="14" height="8" rx="1" fill="white" opacity="0.6"/>
      <rect x="3" y="6" width="14" height="8" rx="1" fill="white" opacity="0.8"/>
      <rect x="6" y="0" width="14" height="8" rx="1" fill="white"/>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">Amazon Bedrock</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Intent</text>
    <text x="80" y="72" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Classification</text>
    <text x="80" y="92" font-size="10" fill="#94a3b8" text-anchor="middle">Zero-shot / Fine-tuned</text>
  </g>

  <!-- Arrow Down -->
  <path d="M820 270 L820 300 L420 300 L420 310" fill="none" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Escalation arrow (right, to HITL) -->
  <path d="M900 215 L950 215" fill="none" stroke="#ef5350" stroke-width="2.5" marker-end="url(#arrRed)" filter="url(#glow)"/>
  <text x="910" y="205" font-size="9" fill="#ef5350" font-weight="bold">âš  Escalation</text>
  <text x="910" y="230" font-size="9" fill="#ef5350">Keywords</text>

  <!-- Stage 4: OpenSearch (RAG Retrieval) -->
  <g transform="translate(340,320)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#3B48CC" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#dbGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#dbGrad)"/>
    <!-- OpenSearch icon: magnifying glass -->
    <g transform="translate(8,3)">
      <circle cx="9" cy="9" r="7" fill="none" stroke="white" stroke-width="2"/>
      <line x1="14" y1="14" x2="20" y2="20" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
    </g>
    <text x="32" y="18" font-size="11" fill="white" font-weight="bold">OpenSearch</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">RAG Retrieval</text>
    <text x="80" y="72" font-size="10" fill="#94a3b8" text-anchor="middle">k-NN Vector Search</text>
    <text x="80" y="88" font-size="9" fill="#64748b" text-anchor="middle">Titan Embeddings 1024-d</text>
    <text x="80" y="100" font-size="9" fill="#64748b" text-anchor="middle">Strict Mode (â‰¥ 0.7)</text>
  </g>

  <!-- Arrow -->
  <line x1="500" y1="375" x2="530" y2="375" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Stage 5: Bedrock (Response Generation) -->
  <g transform="translate(540,320)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#01A88D" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#aiGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#aiGrad)"/>
    <!-- Bedrock icon -->
    <g transform="translate(8,3)">
      <rect x="0" y="12" width="14" height="8" rx="1" fill="white" opacity="0.6"/>
      <rect x="3" y="6" width="14" height="8" rx="1" fill="white" opacity="0.8"/>
      <rect x="6" y="0" width="14" height="8" rx="1" fill="white"/>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">Amazon Bedrock</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Response</text>
    <text x="80" y="72" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Generation</text>
    <text x="80" y="92" font-size="10" fill="#94a3b8" text-anchor="middle">Claude 3.5 Sonnet</text>
  </g>

  <!-- Arrow -->
  <line x1="700" y1="375" x2="730" y2="375" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Stage 6: Bedrock Guardrails (Validation) -->
  <g transform="translate(740,320)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#01A88D" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#aiGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#aiGrad)"/>
    <!-- Guardrail icon: shield with check -->
    <g transform="translate(8,2)">
      <path d="M10,0 L20,5 L20,13 Q20,20 10,22 Q0,20 0,13 L0,5 Z" fill="none" stroke="white" stroke-width="1.8"/>
      <polyline points="5,11 9,15 16,7" fill="none" stroke="white" stroke-width="2"/>
    </g>
    <text x="32" y="18" font-size="11" fill="white" font-weight="bold">Bedrock Guardrails</text>
    <text x="80" y="55" font-size="12" fill="white" font-weight="bold" text-anchor="middle">5-Layer</text>
    <text x="80" y="72" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Validation</text>
    <text x="80" y="90" font-size="9" fill="#94a3b8" text-anchor="middle">Payout Â· Toxicity Â· Halluc.</text>
    <text x="80" y="102" font-size="9" fill="#94a3b8" text-anchor="middle">Off-Topic Â· Content Filter</text>
  </g>

  <!-- Decision Diamond -->
  <g transform="translate(920,340)">
    <path d="M35,0 L70,35 L35,70 L0,35 Z" fill="#1e293b" stroke="#ff9900" stroke-width="2.5"/>
    <text x="35" y="32" font-size="10" fill="#ff9900" text-anchor="middle" font-weight="bold">Auto</text>
    <text x="35" y="45" font-size="10" fill="#ff9900" text-anchor="middle" font-weight="bold">or HITL?</text>
  </g>

  <!-- Arrow to diamond -->
  <line x1="900" y1="375" x2="920" y2="375" stroke="#90a4ae" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Auto-approve path (down) -->
  <path d="M955 410 L955 480 L1060 480" fill="none" stroke="#4CAF50" stroke-width="2.5" marker-end="url(#arrGreen)" filter="url(#glow)"/>
  <text x="965" y="455" font-size="10" fill="#4CAF50" font-weight="bold">âœ… Auto-Approve</text>
  <text x="965" y="468" font-size="9" fill="#81C784">(General â‰¥ 90%)</text>

  <!-- HITL Review path (up to HITL box) -->
  <path d="M990 375 L1060 375 L1060 260" fill="none" stroke="#ff9900" stroke-width="2.5" marker-end="url(#arrGold)" filter="url(#glow)"/>
  <text x="1010" y="365" font-size="10" fill="#ff9900" font-weight="bold">ğŸŸ¡ HITL</text>

  <!-- ===================== HITL DASHBOARD ===================== -->
  <g transform="translate(960,148)" filter="url(#sh)">
    <rect width="160" height="110" rx="8" fill="#1e293b" stroke="#ff9900" stroke-width="2.5"/>
    <!-- Cognito person icon -->
    <g transform="translate(10,10)">
      <circle cx="10" cy="6" r="5" fill="none" stroke="#DD344C" stroke-width="1.5"/>
      <path d="M0,20 Q0,12 10,12 Q20,12 20,20" fill="none" stroke="#DD344C" stroke-width="1.5"/>
    </g>
    <text x="35" y="18" font-size="10" fill="#DD344C" font-weight="bold">Amazon Cognito</text>
    <text x="35" y="30" font-size="8" fill="#94a3b8">(MFA Required)</text>
    <line x1="10" y1="38" x2="150" y2="38" stroke="#334155" stroke-width="1"/>
    <text x="80" y="58" font-size="13" fill="white" font-weight="bold" text-anchor="middle">HITL Dashboard</text>
    <text x="80" y="75" font-size="10" fill="#94a3b8" text-anchor="middle">Streamlit Review UI</text>
    <text x="80" y="96" font-size="9" fill="#64748b" text-anchor="middle">Approve Â· Edit Â· Reject Â· Escalate</text>
  </g>

  <!-- HITL to output -->
  <path d="M1040 258 L1040 280 L1100 280 L1100 470" fill="none" stroke="#ff9900" stroke-width="2" marker-end="url(#arrGold)"/>

  <!-- Escalation line from Classification -->
  <path d="M950 215 L1040 215 L1040 148" fill="none" stroke="#ef5350" stroke-width="2" marker-end="url(#arrRed)"/>

  <!-- ===================== OUTPUT: RESPONSE SENDER ===================== -->
  <g transform="translate(1070,490)" filter="url(#sh)">
    <rect width="160" height="100" rx="8" fill="#1e293b" stroke="#ED7100" stroke-width="2"/>
    <rect width="160" height="28" rx="8" fill="url(#computeGrad)"/>
    <rect x="0" y="14" width="160" height="14" fill="url(#computeGrad)"/>
    <g transform="translate(8,4)">
      <text font-size="16" fill="white" font-weight="bold">Î»</text>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">AWS Lambda</text>
    <text x="80" y="52" font-size="12" fill="white" font-weight="bold" text-anchor="middle">Response Sender</text>
    <text x="80" y="70" font-size="10" fill="#94a3b8" text-anchor="middle">PII Restore â†’ SES</text>
    <text x="80" y="86" font-size="9" fill="#64748b" text-anchor="middle">Audit â†’ S3 Object Lock</text>
  </g>

  <!-- ===================== SECTION 3: DATA STORES ===================== -->
  <text x="80" y="600" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">DATA &amp; STORAGE LAYER</text>
  <line x1="80" y1="608" x2="300" y2="608" stroke="#ff9900" stroke-width="2"/>

  <!-- S3 Buckets -->
  <g transform="translate(80,630)" filter="url(#sh)">
    <rect width="180" height="100" rx="8" fill="#1e293b" stroke="#3F8624" stroke-width="2"/>
    <rect width="180" height="28" rx="8" fill="url(#storGrad)"/>
    <rect x="0" y="14" width="180" height="14" fill="url(#storGrad)"/>
    <!-- S3 bucket icon -->
    <g transform="translate(8,3)">
      <ellipse cx="10" cy="4" rx="10" ry="4" fill="none" stroke="white" stroke-width="1.5"/>
      <path d="M0,4 L0,18" stroke="white" stroke-width="1.5"/>
      <path d="M20,4 L20,18" stroke="white" stroke-width="1.5"/>
      <ellipse cx="10" cy="18" rx="10" ry="4" fill="none" stroke="white" stroke-width="1.5"/>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">Amazon S3</text>
    <text x="90" y="50" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“ Raw Messages</text>
    <text x="90" y="64" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“ Attachments</text>
    <text x="90" y="78" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“Š Audit Logs (Object Lock)</text>
    <text x="90" y="92" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ”„ Fine-tuning Data</text>
  </g>

  <!-- DynamoDB -->
  <g transform="translate(290,630)" filter="url(#sh)">
    <rect width="180" height="100" rx="8" fill="#1e293b" stroke="#3B48CC" stroke-width="2"/>
    <rect width="180" height="28" rx="8" fill="url(#dbGrad)"/>
    <rect x="0" y="14" width="180" height="14" fill="url(#dbGrad)"/>
    <!-- DynamoDB icon: table -->
    <g transform="translate(8,3)">
      <rect x="0" y="0" width="18" height="18" rx="2" fill="none" stroke="white" stroke-width="1.5"/>
      <line x1="0" y1="6" x2="18" y2="6" stroke="white" stroke-width="1"/>
      <line x1="0" y1="12" x2="18" y2="12" stroke="white" stroke-width="1"/>
      <line x1="9" y1="0" x2="9" y2="18" stroke="white" stroke-width="1"/>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">Amazon DynamoDB</text>
    <text x="90" y="50" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“‹ Tickets Table</text>
    <text x="90" y="64" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ’¬ Conversation State</text>
    <text x="90" y="78" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ‘¤ Customer Profiles</text>
    <text x="90" y="92" font-size="9" fill="#64748b" text-anchor="middle">GSI: status Â· customer Â· email</text>
  </g>

  <!-- OpenSearch (standalone) -->
  <g transform="translate(500,630)" filter="url(#sh)">
    <rect width="180" height="100" rx="8" fill="#1e293b" stroke="#3B48CC" stroke-width="2"/>
    <rect width="180" height="28" rx="8" fill="url(#dbGrad)"/>
    <rect x="0" y="14" width="180" height="14" fill="url(#dbGrad)"/>
    <g transform="translate(8,3)">
      <circle cx="9" cy="9" r="7" fill="none" stroke="white" stroke-width="1.8"/>
      <line x1="14" y1="14" x2="20" y2="20" stroke="white" stroke-width="2" stroke-linecap="round"/>
    </g>
    <text x="32" y="18" font-size="11" fill="white" font-weight="bold">OpenSearch Serverless</text>
    <text x="90" y="50" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“„ Policy Documents</text>
    <text x="90" y="64" font-size="10" fill="#94a3b8" text-anchor="middle">ğŸ“œ Historical Tickets</text>
    <text x="90" y="78" font-size="10" fill="#94a3b8" text-anchor="middle">âš–ï¸ Compliance Rules</text>
    <text x="90" y="92" font-size="9" fill="#64748b" text-anchor="middle">HNSW k-NN Â· 1024-dim</text>
  </g>

  <!-- ===================== SECTION 4: MESSAGING ===================== -->
  <text x="720" y="600" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">MESSAGING &amp; QUEUES</text>
  <line x1="720" y1="608" x2="920" y2="608" stroke="#ff9900" stroke-width="2"/>

  <!-- SNS -->
  <g transform="translate(720,630)" filter="url(#sh)">
    <rect width="140" height="100" rx="8" fill="#1e293b" stroke="#E7157B" stroke-width="2"/>
    <rect width="140" height="28" rx="8" fill="url(#intGrad)"/>
    <rect x="0" y="14" width="140" height="14" fill="url(#intGrad)"/>
    <!-- SNS icon: bell -->
    <g transform="translate(8,3)">
      <path d="M10,2 Q16,2 16,12 L18,14 L2,14 L4,12 Q4,2 10,2" fill="none" stroke="white" stroke-width="1.5"/>
      <line x1="10" y1="14" x2="10" y2="18" stroke="white" stroke-width="1.5"/>
    </g>
    <text x="26" y="18" font-size="12" fill="white" font-weight="bold">Amazon SNS</text>
    <text x="70" y="52" font-size="10" fill="#94a3b8" text-anchor="middle">Orchestration Topic</text>
    <text x="70" y="68" font-size="10" fill="#94a3b8" text-anchor="middle">HITL Notifications</text>
    <text x="70" y="84" font-size="10" fill="#94a3b8" text-anchor="middle">Alarm Alerts</text>
  </g>

  <!-- SQS -->
  <g transform="translate(890,630)" filter="url(#sh)">
    <rect width="140" height="100" rx="8" fill="#1e293b" stroke="#E7157B" stroke-width="2"/>
    <rect width="140" height="28" rx="8" fill="url(#intGrad)"/>
    <rect x="0" y="14" width="140" height="14" fill="url(#intGrad)"/>
    <!-- SQS icon: queue bars -->
    <g transform="translate(8,5)">
      <rect x="0" y="0" width="4" height="16" rx="1" fill="white"/>
      <rect x="6" y="3" width="4" height="13" rx="1" fill="white" opacity="0.8"/>
      <rect x="12" y="6" width="4" height="10" rx="1" fill="white" opacity="0.6"/>
    </g>
    <text x="26" y="18" font-size="12" fill="white" font-weight="bold">Amazon SQS</text>
    <text x="70" y="52" font-size="10" fill="#94a3b8" text-anchor="middle">HITL Review Queue</text>
    <text x="70" y="68" font-size="10" fill="#94a3b8" text-anchor="middle">Dead Letter Queue</text>
    <text x="70" y="84" font-size="9" fill="#64748b" text-anchor="middle">Callback Pattern</text>
  </g>

  <!-- ===================== SECTION 5: SECURITY & MONITORING ===================== -->
  <text x="1060" y="600" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">SECURITY &amp; OPS</text>
  <line x1="1060" y1="608" x2="1230" y2="608" stroke="#ff9900" stroke-width="2"/>

  <!-- KMS -->
  <g transform="translate(1060,630)" filter="url(#sh)">
    <rect width="140" height="100" rx="8" fill="#1e293b" stroke="#DD344C" stroke-width="2"/>
    <rect width="140" height="28" rx="8" fill="url(#secGrad)"/>
    <rect x="0" y="14" width="140" height="14" fill="url(#secGrad)"/>
    <!-- KMS icon: key -->
    <g transform="translate(8,4)">
      <circle cx="6" cy="6" r="5" fill="none" stroke="white" stroke-width="1.5"/>
      <line x1="11" y1="6" x2="20" y2="6" stroke="white" stroke-width="1.5"/>
      <line x1="17" y1="6" x2="17" y2="10" stroke="white" stroke-width="1.5"/>
      <line x1="20" y1="6" x2="20" y2="10" stroke="white" stroke-width="1.5"/>
    </g>
    <text x="30" y="18" font-size="12" fill="white" font-weight="bold">AWS KMS</text>
    <text x="70" y="52" font-size="10" fill="#94a3b8" text-anchor="middle">CMK Encryption</text>
    <text x="70" y="68" font-size="10" fill="#94a3b8" text-anchor="middle">Auto Key Rotation</text>
    <text x="70" y="84" font-size="9" fill="#64748b" text-anchor="middle">S3 + DynamoDB + OS</text>
  </g>

  <!-- CloudWatch -->
  <g transform="translate(1230,630)" filter="url(#sh)">
    <rect width="140" height="100" rx="8" fill="#1e293b" stroke="#E7157B" stroke-width="2"/>
    <rect width="140" height="28" rx="8" fill="url(#mgmtGrad)"/>
    <rect x="0" y="14" width="140" height="14" fill="url(#mgmtGrad)"/>
    <!-- CloudWatch icon: eye/monitor -->
    <g transform="translate(8,4)">
      <circle cx="10" cy="8" r="3" fill="none" stroke="white" stroke-width="1.5"/>
      <path d="M0,8 Q10,0 20,8 Q10,16 0,8" fill="none" stroke="white" stroke-width="1.5"/>
    </g>
    <text x="30" y="18" font-size="11" fill="white" font-weight="bold">CloudWatch</text>
    <text x="70" y="52" font-size="10" fill="#94a3b8" text-anchor="middle">Lambda Logs</text>
    <text x="70" y="68" font-size="10" fill="#94a3b8" text-anchor="middle">DLQ Alarms</text>
    <text x="70" y="84" font-size="10" fill="#94a3b8" text-anchor="middle">Step Fn Metrics</text>
  </g>

  <!-- ===================== VPC Label ===================== -->
  <rect x="60" y="770" width="1320" height="50" rx="8" fill="#1e293b" stroke="#8C4FFF" stroke-width="2"/>
  <g transform="translate(75,780)">
    <rect x="0" y="0" width="16" height="16" rx="2" fill="#8C4FFF"/>
    <text x="8" y="12" font-size="10" fill="white" text-anchor="middle" font-weight="bold">V</text>
  </g>
  <text x="100" y="800" font-size="14" fill="#8C4FFF" font-weight="bold">Amazon VPC</text>
  <text x="210" y="800" font-size="12" fill="#94a3b8">Private Subnets Â· NAT Gateway Â· 8 VPC Endpoints (S3, DynamoDB, Bedrock, SageMaker, Comprehend, SQS, SNS, Step Functions)</text>

  <!-- ===================== LEGEND ===================== -->
  <text x="80" y="860" font-size="15" fill="#ff9900" font-weight="bold" letter-spacing="1">AWS SERVICE CATEGORIES</text>
  <line x1="80" y1="868" x2="320" y2="868" stroke="#ff9900" stroke-width="2"/>

  <!-- Legend items -->
  <g transform="translate(80,885)">
    <rect width="14" height="14" rx="3" fill="url(#computeGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">Compute (Lambda)</text>
  </g>
  <g transform="translate(230,885)">
    <rect width="14" height="14" rx="3" fill="url(#aiGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">AI/ML (Bedrock, SageMaker, Comprehend)</text>
  </g>
  <g transform="translate(560,885)">
    <rect width="14" height="14" rx="3" fill="url(#dbGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">Database (DynamoDB, OpenSearch)</text>
  </g>
  <g transform="translate(80,910)">
    <rect width="14" height="14" rx="3" fill="url(#storGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">Storage (S3)</text>
  </g>
  <g transform="translate(230,910)">
    <rect width="14" height="14" rx="3" fill="url(#secGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">Security (KMS, Cognito)</text>
  </g>
  <g transform="translate(460,910)">
    <rect width="14" height="14" rx="3" fill="url(#intGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">App Integration (SNS, SQS, API GW, SES)</text>
  </g>
  <g transform="translate(770,910)">
    <rect width="14" height="14" rx="3" fill="url(#netGrad)"/>
    <text x="22" y="12" font-size="11" fill="#e2e8f0">Networking (VPC, Endpoints)</text>
  </g>

  <!-- ===================== FOOTER ===================== -->
  <text x="720" y="970" font-size="11" fill="#475569" text-anchor="middle">Infrastructure as Code: AWS CDK (7 Stacks) Â· NetworkStack Â· SecurityStack Â· StorageStack Â· SearchStack Â· MLStack Â· IngestionStack Â· OrchestrationStack</text>
  <text x="720" y="990" font-size="10" fill="#334155" text-anchor="middle">Â© 2026 Insurance AI Agent â€” Production Architecture v1.0</text>
</svg>
